<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Enter Time, Get Distance!</title>
  <link rel="stylesheet" href="./css/styles.css" />
  <style>
    #result {
      margin-top: 20px;
      background: #e7f3ff;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
      text-align: center;
    }
    .warning {
      color: red;
      font-weight: bold;
    }
    .distance-box {
      font-size: 1.6rem;
      background: #2196f3;
      color: white;
      border-radius: 8px;
      padding: 10px 20px;
      display: inline-block;
      margin-top: 10px;
    }
  </style>
</head>

<body>
  <header>
    <h1>Enter Time, Get Distance!</h1>
  </header>

  <div class="container">
    
    <nav class="sidebar">
      <button onclick="window.location.href='index.html'">Home</button>
      <button onclick="window.location.href='a.html'">Distance Based</button>
    </nav>

    
    <main class="content">
      <form id="timeForm">
        <label for="hours">Enter hours and mins:</label>
        <div class="time-inputs">
          <input type="number" id="hours" placeholder="0" min="0" />
          <input type="number" id="minutes" placeholder="0" min="0" max="59" />
        </div>

        <label for="transport">Transport:</label>
        <select id="transport">
          <option value="Maruti Suzuki Alto">Maruti Suzuki Alto</option>
          <option value="Hyundai i20">Hyundai i20</option>
          <option value="Tata Nexon">Tata Nexon</option>
          <option value="Honda City">Honda City</option>
          <option value="Mahindra Thar">Mahindra Thar</option>
          <option value="Toyota Innova Crysta">Toyota Innova Crysta</option>
          <option value="Kia Seltos">Kia Seltos</option>
          <option value="Renault Kwid">Renault Kwid</option>
          <option value="Ford EcoSport">Ford EcoSport</option>
          <option value="Tata Tiago">Tata Tiago</option>
        </select>

        <button type="submit">Calculate Distance</button>
      </form>

      <div id="result"></div>
      <div id="comparison"></div>
    </main>

    <aside class="about">
      <h2>About</h2>
      <p>
        Enter the time, select the vehicle, and get the distance you can travel in that time — 
        plus a full comparison with all other vehicles.
      </p>
    </aside>
  </div>

  <script>
  document.getElementById("timeForm").addEventListener("submit", async (e) => {
    e.preventDefault();

    const hours = parseFloat(document.getElementById("hours").value) || 0;
    const minutes = parseFloat(document.getElementById("minutes").value) || 0;
    const transport = document.getElementById("transport").value;

    const resultDiv = document.getElementById("result");
    const comparisonDiv = document.getElementById("comparison");

    resultDiv.innerHTML = "<p>⏳ Calculating...</p>";
    comparisonDiv.innerHTML = "";

    try {
      const response = await fetch("http://localhost:8000/calculate-distance", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ hours, minutes, vehicle: transport }) 
      });

      const data = await response.json();

      if (data.error) {
        resultDiv.innerHTML = `<p class="warning">${data.error}</p>`;
        return;
      }

      const selected = data.selected;

      resultDiv.innerHTML = `
        <h3>${selected.vehicle}</h3>
        <div class="distance-box">${selected.distance} km</div>
        <p><strong>Fuel Used:</strong> ${selected.fuelUsed} L</p>
        <p><strong>Status:</strong> ${selected.status}</p>
      `;

      let comparisonHTML = `
        <h3>Comparison with other vehicles:</h3>
        <ul style='text-align:left'>
      `;

      for (const v of data.comparison) {
        comparisonHTML += `
          <li>
            <b>${v.name}:</b> ${v.distance} km, ${v.fuelUsed} L — ${v.status}
          </li>`;
      }

      comparisonHTML += "</ul>";
      comparisonDiv.innerHTML = comparisonHTML;

    } catch (err) {
      resultDiv.innerHTML = `<p class="warning">Error connecting to server! Make sure it's running.</p>`;
    }
  });
</script>

</body>
</html>